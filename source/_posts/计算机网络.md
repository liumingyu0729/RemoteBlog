---
title: 计算机网络
date: 2019-11-12 14:31:47
tags:
---
### 概述
TCP/IP协议栈
局域网：以太网 令牌环 FDDI ATM

&nbsp;| OSI| 协议
:-: | :-: | :-:
应用层 | 应用层 表示层 会话层 | DNS FTP HTTP POP Telnet
传输层 | 传输层 | TCP UDP
网络层 | 网络层 | IP
数据链路层 | 数据链路层 | ARP MAC
物理层 | 物理层 | &nbsp;

协议数据单元 PDU 服务数据单元 SDU 服务访问点 SAP
传输层/网络层/数据链路层/物理层 封装在操作系统内
### 中间设备
网关（连接两个不兼容的系统）

物理层 | 数据链路层 | 网络层 
:-: | :-: | :-: 
转发器 | 网桥 | 路由器 

### 链路层
MAC地址 6字节 适配器 （MAC广播地址 FF-FF-FF-FF-FF-FF）
以太网帧

前同步码 | 目的地址 | 源地址 | 类型 | 数据 | CRC 
:-: | :-: | :-: | :-: | :-: | :-:
8 | 6 | 6 | 2 | 46-1500 | 4

数据长度46-1500（MTU最大传输单元）字节 分片 填充
CRC循环冗余检测

ARP地址解析协议（同一子网）: IP地址 -> MAC地址
RARP协议: 物理地址 -> IP地址  
ARP表：主机或路由器内存中 IP与MAC映射 TTL寿命值（一般20分钟）
ARP查询原理：
1，发送方（ARP表无目标MAC映射）
2，->ARP查询包（MAC广播地址）->封装进帧
3，（路由转接口 重新封装进帧->）
4，<-ARP响应包
5，ARP表更新
6，IP数据包->

### 网络层
32比特
IPv4
<table>
    <tr>
        <td align="center">版本</td> 
        <td align="center">首部长度</td>
        <td align="center">服务类型</td> 
        <td colspan="2" align="center">数据报长度（字节）</td>
   </tr>
    <tr>
        <td colspan="3" align="center">16比特标识</td>
        <td colspan="1" align="center">标志</td>
        <td colspan="1" align="center">13比特片偏移</td>
    </tr>
    <tr>
        <td colspan="2" align="center">寿命</td> 
        <td colspan="1" align="center">上层协议</td> 
        <td colspan="2" align="center">首部验证和</td>    
    </tr>
    <tr>
        <td colspan="5" align="center">源IP地址（32比特）</td> 
    </tr>
    <tr>
        <td colspan="5" align="center">目的IP地址（32比特）</td> 
    </tr>
    <tr>
        <td colspan="5" align="center">选项</td> 
    </tr>
    <tr>
        <td colspan="5" align="center">数据</td> 
    </tr>
</table>
32比特
IPv6
<table>
    <tr>
        <td colspan="1" align="center">版本</td> 
        <td colspan="1" align="center">流量类型</td>
        <td colspan="3" align="center">流量标签</td> 
   </tr>
    <tr>
        <td colspan="3" align="center">有效载荷长度</td>
        <td colspan="1" align="center">下一个首部</td>
        <td colspan="1" align="center">跳限制</td>
    </tr>
    <tr>
        <td colspan="5" align="center">源地址（128比特）</td> 
    </tr>
    <tr>
        <td colspan="5" align="center">目的地址（128比特）</td> 
    </tr>
    <tr>
        <td colspan="5" align="center">数据</td> 
    </tr>
</table>

IPv4地址 4字节 0-255 
IP分片：IP数据报分成多个IP数据报再分别封装进帧，端系统重新组装
CIDR无类别域间路由选择 子网掩码 a.b.c.d/x
分类编址 A B C类网络 /24 /16 /8 
容量2^n-2 
IP广播地址 255.255.255.255
DHCP动态主机配置协议
ICMP因特网控制报文协议：主机和路由器之间传网络层信息
ICMP报文：类型字段 + 编码字段 + 引起的IP报文首部和前8字节（ping 8+0）

ICMP类型 | 编码 | 描述
:-: | :-: | :-: 
0 | 0 | 回显回答（对ping回答）
3 | 0 | 目的网络不可达
3 | 1 | 目的主机不可达
3 | 2 | 目的协议不可达
3 | 3 | 目的端口不可达
3 | 6 | 目的网络未知
3 | 7 | 目的主机未知
4 | 0 | 源抑制（拥塞控制）
8 | 0 | 回显请求
9 | 0 | 路由通告
10 | 0 | 路由发现
11 | 0 | TTL国企
12 | 0 | IP首部损坏

### 传输层
&emsp;UDP协议
&emsp;TCP协议
&emsp;TCP连接控制
&emsp;TCP流量控制
&emsp;TCP超时重传
### 应用层
&emsp;DNS协议
&emsp;FTP协议
&emsp;HTTP协议
&emsp;&emsp;报文格式：请求报文 响应报文 请求头字段 响应头字段
&emsp;&emsp;状态码
&emsp;HTTPS协议
&emsp;&emsp;详细的握手过程
&emsp;&emsp;摘要算法 数字签名 数字证书

集线器 hub | 交换机 switch | 路由器
:-: | :-: | :-: 
物理层 | 数据链路层 | 网络层
碰撞重传 能量放大 | 透明 无碰撞 | &nbsp;

交换机 过滤 转发 
&emsp;交换机表（MAC与接口映射 自学习）
